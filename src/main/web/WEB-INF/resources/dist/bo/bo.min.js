!function(){var a=angular.module("boApp",["frontServices","ui.bootstrap","textAngular","ngSanitize","pascalprecht.translate","ngCookies","ngResource"]);a.config(function(a){var b;angular.injector(["ngCookies"]).invoke(["$cookies",function(a){b=a}]),a.useSanitizeValueStrategy("sanitize");var c=b.get("language");void 0==c&&(c="en"),a.preferredLanguage(c),a.useLoader("i18nLoader")}),a.run(function(a){}),a.factory("i18nLoader",function(a,b,c){return function(d){var e=b.defer();return a.get(c.URL_I18N+d.key+".json").then(function(a){e.resolve(a.data)}).catch(function(a){console.log(a.status),console.log(a),e.reject(d.key)}),e.promise}})}();var fModule=angular.module("boApp");fModule.controller("DatepickerPopupCtrl",["$scope",function(a){function b(a){var b=a.date;return"day"===a.mode&&(0===b.getDay()||6===b.getDay())}function c(b){var c=b.date;if("day"===b.mode)for(var d=new Date(c).setHours(0,0,0,0),e=0;e<a.events.length;e++){var f=new Date(a.events[e].date).setHours(0,0,0,0);if(d===f)return a.events[e].status}return""}a.init=function(b){a.dt=new Date(b)},a.today=function(){a.dt=new Date},a.today(),a.clear=function(){a.dt=null},a.inlineOptions={customClass:c,minDate:new Date,showWeeks:!0},a.dateOptions={dateDisabled:b,formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},a.toggleMin=function(){a.inlineOptions.minDate=a.inlineOptions.minDate?null:new Date,a.dateOptions.minDate=a.inlineOptions.minDate},a.toggleMin(),a.open1=function(){a.popup1.opened=!0},a.open2=function(){a.popup2.opened=!0},a.setDate=function(b,c,d){a.dt=new Date(b,c,d)},a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.format=a.formats[0],a.altInputFormats=["M!/d!/yyyy"],a.popup1={opened:!1},a.popup2={opened:!1};var d=new Date;d.setDate(d.getDate()+1);var e=new Date;e.setDate(d.getDate()+1),a.events=[{date:d,status:"full"},{date:e,status:"partially"}]}]);var fModule=angular.module("boApp");fModule.controller("WysiwygEditorCtrl",["$scope","textAngularManager",function(a,b){a.version=b.getVersion(),a.versionNumber=a.version.substring(1),a.disabled=!1}]),function(){var a=angular.module("boApp");a.directive("uiObjectAssignment",["$parse","boConfig",function(a,b){return{restrict:"E",require:"?ngModel",transclude:!0,templateUrl:b.tplPath+"/ui-object-assignement.html",controller:["$scope","UiAssignmentService",function(b,c){b.open=function(d){c.getObjects(b[b.model],b.type,b.id,b.field,b.kind,b.many,b.disablePreChecked,d).then(function(c){a(b.model).assign(b.$parent,c)}).catch(function(a){console.log(a.status),console.log(a)})}}],scope:!0,link:function(a,b,c,d){a.type=c.type,a.field=c.field,a.id=c.id,a.model=c.ngModel,a.kind=c.kind,a.many="true"==c.many,a.disablePreChecked="true"==c.disablePreChecked}}}]),a.directive("uiFileAssignment",["$parse","boConfig",function(a,b){return{restrict:"E",require:"?ngModel",transclude:!0,templateUrl:b.tplPath+"/ui-file-assignement.html",controller:["$scope","UiAssignmentService","idProvidersFilter",function(b,c,d){b.add=function(d){c.getObjects(b[b.model],b.type,b.id,b.field,b.kind,b.many,b.disablePreChecked,d).then(function(c){var d=[];angular.extend(d,b[b.model]),console.log(d),angular.forEach(c,function(a,b){-1==d.indexOf(a)&&d.push(a)}),a(b.model).assign(b.$parent,d,a)}).catch(function(a){console.log(a.status),console.log(a)})},b.clear=function(){var c=[];a(b.model).assign(b.$parent,c);var c=[];a(b.model).assign(b.$parent,c)}}],scope:!0,link:function(a,b,c,d){a.type=c.type,a.field=c.field,a.id=c.id,a.model=c.ngModel,a.kind=c.kind,a.many="true"==c.multiSelect,a.disablePreChecked="true"==c.disablePreChecked}}}]),a.directive("input",["$parse","idProvidersFilter","stringsFilter","$compile","$http","boConfig",function(a,b,c,d,e,f){return{restrict:"E",require:"?ngModel",controller:["$scope","$element","$attrs",function(a,b,c){if(c.assign){var g=!1;c.disablePreChecked&&(g=c.disablePreChecked);var h=c.assign.split("_"),i=h[0],j=h[1],k=h[2],l=c.kind;void 0===l&&(l="object");var m=c.many;if(void 0===m)m="";else{m=" "+("file"==l?"multi-select":"many")+'="'+m+'"'}var n=c.ngModel,o=d("<data-ui-"+l+'-assignment type="'+i+'" field="'+k+'" id="'+j+'" ng-model="'+n+'" kind="'+l+'"'+m+' disable-pre-checked="'+g+'"/></data-ui-'+l+"-assignment>")(a);b.parent().append(o);var p=c.ngModel+"Text";if("file"==l){var q=d('<ul class="linked"><li data-ng-repeat="r in '+p+' | orderBy: \'name\'"><ui-file url="r" /></li><li data-ng-show="'+n+".length - "+p+'.length > 0"><strong><a href="#">{{'+n+".length - "+p+".length}} <span>Others results...</span></a></strong></li></ul>")(a);b.parent().append(q),a.$watch(n,function(){var b=5,c=a[n],d=[];if(c&&c.length>0){b?c.length<b&&(b=c.length):b=c.length;for(var e=0;e<b;e++)d.push(f.basePath+"/"+c[e])}a[p]=d})}else{var q=d('<ul class="linked"><li data-ng-repeat="r in '+p+' | orderBy: \'name\'"><a class="linked" href="#">{{r.name}}</a></li><li data-ng-show="'+n+".length - "+p+'.length > 0"><strong><a href="#">{{'+n+".length - "+p+".length}} <span>Others results...</span></a></strong></li></ul>")(a);b.parent().append(q),a.$watch(n,function(){var b=5,c=a[n];if(c&&c.length>0){b?c.length<b&&(b=c.length):b=c.length;for(var d=c[0].type,g=[],h=0;h<b;h++)c[h].id&&g.push(c[h].id);g.length>0&&e.get(f.basePath+"/bo/list/objects/"+d,{params:{id:g}}).then(function(b){a[p]=b.data})}})}}}],link:function(d,e,f,g){var h=f.kind;void 0===h&&(h="object");var i="true"==f.many;f.ngModel&&f.assign&&("object"==h?(a(f.ngModel).assign(d,b(f.value,"toArray")),g.$parsers.push(function(a){return b(a,"toArray")}),g.$formatters.push(function(a){return b(a)})):"file"==h?(a(f.ngModel).assign(d,c(f.value,"toArray")),g.$parsers.push(function(a){return c(a,"toArray")}),g.$formatters.push(function(a){return c(a,null,!i)})):a(f.ngModel).assign(d,f.value))}}}]),a.filter("idProviders",function(){return function(a,b){if(b||(b="toString"),"toArray"==b){var c=a.split(","),d=[];return angular.forEach(c,function(a){if(""!=a){var b=a.split("_");d.push({type:b[0],id:Number(b[1])})}}),d}var c="";return angular.forEach(a,function(a){c+=a.type+"_"+a.id+","}),c}}),a.filter("strings",function(){var a=function(a){var b=a.replace(/[\u00A0-\u9999<>\&]/gim,function(a){return"&#"+a.charCodeAt(0)+";"});return b=b.replace(/,/g,"&c"),b=b.replace(/\[/g,"&o"),b=b.replace(/\]/g,"&f")},b=function(a){var b=function(){function a(a){return a&&"string"==typeof a&&(a=a.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),a=a.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),b.innerHTML=a,a=b.textContent,b.textContent=""),a}var b=document.createElement("div");return a}(),c=b(a);return c=c.replace(/&c/g,","),c=c.replace(/&o/g,"["),c=c.replace(/&f/g,"]")};return function(c,d,e){if(d||(d="toString"),e||(e=!1),"toArray"==d){if("["==c.charAt(0)&&"]"==c.charAt(c.length-1)){var f=c.substring(1,c.length-1),f=f.split(","),g=[];return angular.forEach(f,function(a){""!=a&&g.push(b(a))}),g}console.log(c);var g=[];return""!=c&&g.push(b(c)),g}if(c&&1==c.length&&e)return c[0];var f="";return angular.forEach(c,function(b){f+=a(b)+","}),""!=f&&(f="["+f+"]"),f}}),a.service("UiAssignmentService",["$q","$log","$uibModal","boConfig",function(a,b,c,d){self=this,self.getObjects=function(e,f,g,h,i,j,k,l,m,n){e||b.error("values is mandatory !"),f||b.error("objectType is mandatory !"),h||b.error("objectField is mandatory !"),i||(i="object"),l||(l="lg"),m||(m=5),n||(n=0);var o=a.defer(),p=i.charAt(0).toUpperCase()+i.slice(1);return c.open({templateUrl:d.tplPath+"/ui-"+i+"-assignement-modal.html",controller:"Ui"+p+"AssignmentModalCtrl",size:l,resolve:{values:function(){return e},urlInfos:function(){return{type:f,field:h,id:g,many:j,pageable:{size:m,page:n}}},disablePreChecked:function(){return k},kind:function(){return i}}}).result.then(function(a){o.resolve(a)},function(){console.log("Modal dismissed at: "+new Date)}),o.promise}}]),a.controller("UiObjectAssignmentModalCtrl",["$rootScope","$scope","$uibModalInstance","boConfig","values","urlInfos","kind","disablePreChecked",function(a,b,c,d,e,f,g,h){b.init=function(a){b.values=[],angular.extend(b.values,e);for(var c=0;c<b.values.length;c++)b.lastCheckedId=b.values[c].id,b["chk"+b.values[c].id]=!0,!0===a&&(b["dsb"+b.values[c].id]=!0)},b.init(h),b.updateValues=function(a,c,d){if(d)b.values.push({type:a,id:c});else{for(var e=null,f=0;f<b.values.length;f++)if(b.values[f].id==c&&b.values[f].type==a){e=f;break}null!=e&&b.values.splice(e,1)}},b.overrideValues=function(a,c){b.values=[{type:a,id:c}]},b.mkParams=function(a){var b="",c="?";return a.size&&(b+=c+"size="+a.size,c="&"),a.sort&&(b+=c+"sort="+a.sort,c="&"),a.page&&(b+=c+"page="+a.page,c="&"),b},b.mkUrl=function(a){var c=""==a.id?0:a.id,e=d.basePath+"/bo/blocklist/"+a.type+"/"+c+"/"+a.field;b.urlInfos=a,b.urlMaked=e+b.mkParams(a.pageable),b.init()},b.updateUrlType=function(a){f.type=a,b.mkUrl(f)},b.updateUrlPageableSize=function(a){f.pageable.size=a,b.mkUrl(f)},b.updateUrlPageableSort=function(a){f.pageable.sort=a,b.mkUrl(f)},b.updateUrlPageablePage=function(a){f.pageable.page=a,b.mkUrl(f)},b.mkUrl(f),b.cancel=function(){c.dismiss("cancel")},b.save=function(a){a.$valid?c.close(b.values):c.dismiss("cancel")}}]),a.controller("UiFileAssignmentModalCtrl",["$rootScope","$scope","$uibModalInstance","boConfig","values","urlInfos","kind","disablePreChecked",function(a,b,c,d,e,f,g,h){b.mkUrl=function(a){var c=d.basePath+"/bo/file/single/?navbar=false&multi="+a.many;b.urlMaked=c},b.mkUrl(f),a.$on("filemanagerSelectItemChanged",function(a,c){b.values=[];for(var e=0;e<c.length;e++){var f=c[e].model;"file"==f.type&&b.values.push(d.basePath+"/"+d.filesPath+f.fullPath())}b.templateForm&&(b.templateForm.$dirty=b.values.length>0)}),b.cancel=function(){c.dismiss("cancel")},b.save=function(a){a.$valid?c.close(b.values):c.dismiss("cancel")}}])}(),function(){angular.module("boApp").directive("uiFile",["$parse","$q","boConfig",function(a,b,c){return{restrict:"EA",scope:{url:"="},controller:["$scope",function(a){var d=a.url.substring(a.url.lastIndexOf("/")+1);a.name=d,function(a){var c=b.defer(),d=new XMLHttpRequest;return d.onreadystatechange=function(){4==d.readyState&&("404"==d.status?c.resolve(!1):c.resolve(!0))},d.open("GET",a),d.send(),c.promise}(a.url).then(function(b){var d=null;d=b?a.url.split(".").pop().toLowerCase():"404";var e=c.tplPath+"/resources/",f={png:a.url,jpg:a.url,jpeg:a.url,gif:a.url,bmp:a.url,pdf:e+"pdf.png",ND:e+"nd.png",404:e+"404.png",LOADING:e+"loading.png"},g=f[d];null==g&&(g=f.ND),a.src=g})}],templateUrl:c.tplPath+"/ui-file.html",link:function(a,b,c){}}}])}(),function(a){"use strict";a.module("boApp").provider("boConfig",function(){var b={basePath:"",tplPath:"src/bo/js/templates",i18nPath:"src/bo/js/i18n",filePath:"files/"};return{$get:function(){return b},set:function(c){a.extend(b,c)}}})}(angular),function(){angular.module("frontServices",["FileManagerApp"]);angular.module("FileManagerApp").config(["fileManagerConfigProvider",function(a){a.$get();a.set({appName:"Neutrino",listUrl:"/neutrino/bo/file/list/",uploadUrl:"/neutrino/bo/file/add/",renameUrl:"/neutrino/bo/file/rename/",copyUrl:"bridges/php/handler.php",moveUrl:"/neutrino/bo/file/move/",removeUrl:"/neutrino/bo/file/remove/",editUrl:"bridges/php/handler.php",getContentUrl:"bridges/php/handler.php",createFolderUrl:"bridges/php/handler.php",downloadFileUrl:"/neutrino/bo/file/download/",downloadMultipleUrl:"/neutrino/bo/file/downloadMultiple/",compressUrl:"/neutrino/bo/file/compress/",extractUrl:"bridges/php/handler.php",permissionsUrl:"bridges/php/handler.php",pickCallback:function(a){var b='Picked %s "%s" for external use'.replace("%s",a.type).replace("%s",a.fullPath());window.alert(b)},searchForm:!1,sidebar:!0,breadcrumb:!0,navbar:!0,multiSelect:!0,allowedActions:{upload:!0,rename:!0,move:!0,copy:!0,edit:!0,changePermissions:!0,compress:!0,compressChooseName:!0,extract:!0,download:!0,downloadMultiple:!0,preview:!0,remove:!0,createFolder:!0,pickFiles:!1,pickFolders:!1},multipleDownloadFileName:"angular-filemanager.zip",showExtensionIcons:!0,showSizeForDirectories:!1,useBinarySizePrefixes:!1,downloadFilesByAjax:!0,previewImagesInModal:!0,enablePermissionsRecursive:!0,compressAsync:!1,extractAsync:!1,pickCallback:null})}])}(),angular.module("boApp").run(["$templateCache",function(a){"use strict";a.put("src/bo/js/templates/ui-file-assignement-modal.html",'<form name=templateForm class=form-horizontal role=form><div class=modal-header><button type=button class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class=modal-title>{{\'block-management.type\' | translate}} : {{template.template.name}}</h4></div><div class=modal-body><div data-ng-show=template.errors class="alert alert-danger" role=alert><div data-ng-repeat="err in template.errors.data"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden=true></span> <span class=sr-only>Error :</span> {{err.defaultMessage}}</div></div><div data-ng-include=urlMaked></div></div><div class=modal-footer><button data-ng-click=cancel() class="btn btn-danger btn-small">Annuler</button> <button class="btn btn-success" data-ng-disabled="!templateForm.$dirty || templateForm.$invalid" data-ng-click=save(templateForm)>Modifier</button></div></form>'),a.put("src/bo/js/templates/ui-file-assignement.html","<div><a ng-click=\"add('lg')\" class=\"btn btn-primary btn-xs\">{{ many ? 'add' : 'assign' | translate }}</a> <a ng-click=clear() class=\"btn btn-danger btn-xs\">{{ 'reset' | translate }}</a></div>"),a.put("src/bo/js/templates/ui-file.html","<div class=uifile><a ng-href={{url}} target=_blank><div class=content><p class=title>{{name}}</p><p><img ng-src={{src}} alt={{name}}></p></div></a></div>"),a.put("src/bo/js/templates/ui-object-assignement-modal.html",'<form name=templateForm class=form-horizontal role=form><div class=modal-header><button type=button class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class=modal-title>{{\'block-management.type\' | translate}} : {{template.template.name}}</h4></div><div class=modal-body><div data-ng-show=template.errors class="alert alert-danger" role=alert><div data-ng-repeat="err in template.errors.data"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden=true></span> <span class=sr-only>Error :</span> {{err.defaultMessage}}</div></div><div data-ng-include=urlMaked></div></div><div class=modal-footer><button data-ng-click=cancel() class="btn btn-danger btn-small">Annuler</button> <button class="btn btn-success" data-ng-disabled="!templateForm.$dirty || templateForm.$invalid" data-ng-click=save(templateForm)>Modifier</button></div></form>'),a.put("src/bo/js/templates/ui-object-assignement.html","<div><a ng-click=\"open('lg')\" class=\"btn btn-primary btn-xs\">{{ 'assign' | translate }}</a></div>")}]);